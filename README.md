starpy
=======

A python code to determine the quenched star formation history parameters of a galaxy using the MCMC algorithm emcee (http://dan.iel.fm/emcee/current/). Please ensure this module is installed and can be imported into your Python installation.

The sample function implements the emcee EnsembleSampler function for the galaxy colours input. Burn-in is run and calculated for the length specified before the sampler is reset and then run for the length of steps specified. 
        
**INPUTS**

*u_r* : Observed u-r colour of a galaxy; k-corrected. Single value.
        
*err_u_r* : Error on the observed u-r colour of a galaxy. Single value. 
        
*nuv_u* : Observed nuv-u colour of a galaxy; k-corrected. Single value. 
        
*err_nuv_u* : Error on the observed nuv-u colour of a galaxy. Single value. 
        
*z* : Observed redshfit of a galaxy. Single value. 
        
*pd* : Galaxy Zoo disc morphological classification debiased vote fraction. Single value. 
        
*ps* : Galaxy Zoo smooth morphological classification debiased vote fraction. Single value. 
        
*dr8* : Sloan ID DR8 number - can be any identification number for a galaxy. 

*ra* : Right ascension of galaxy in degrees. Used for identification.

*dec* : Declination of galaxy in degrees. Used for identification. 
        
**RETURNS**

*s* : Array of shape (_nsteps_ * _nwalkers_, 2) containing the positions of the walkers at all steps for all 4 parameters. 
       
*fig* : s plotted as contours and integrated over to a each one dimensional histogram with median values and 1sigma                   values either side. The triangle.py module is necessary to produce these plots and is provided in the starfpy                 repository. It can also be downloaded here: https://github.com/dfm/triangle.py or with pip install triangle_plot              at the command line.
    
**Running the code**    

Data inputs occur with the starfpy.py file, all necessary functions are in the posterior.py file. The code can be run as follows:

        python starpy.py u_r, err_u_r, nuv_u, err_nuv_u, z, pd, ps, dr8, ra, dec
        
For example:

        python starpy.py 2.2564125061 0.0635264205263 1.66131782532 0.12668874395 0.0246473997831 0.96025395 0.033525165 1237661968496984320 163.734802246 41.4984283447
        
Returns the 50th percentile of the walker positions from emcee for the quenched star formation history parameters [t, tau] as:
        

        Best fit [t, tau] values found by starpy for input parameters are : [9.3231936694250255, 1.287285042079878]

Data inputs occur with the starpy.py file, all necessary functions are in the posterior.py file. 

You can generate a look up table in two colours with lookup.py or you can use the full functions that take a given SFH and calculate the SED at each time step using the functions in the fluxes.py file. 

You must also extract the necessary SPS models into ASCII files with the "extract_bc03.py" or "extract_m05.py" files to both generate a look-up table with either the BC03 or M05 models or to use the full functions in fluxes.py with each iteration of emcee. 

u-r and NUV-u look up tables have already been generated for 50 observed ages, 100 tau and 100 quenching time values for an exponential quenching SFH model. Using these look up tables or ones generated by the user will ensure run time is ~3 minutes for one galaxy as opposed to ~3 hours. 

You must also extract the necessary SPS models into ASCII files with the 'extract_bc03.py' file or 'extract_m05.py' file if you wish to use the BC03 or M05 SPS models.  

u-r and NUV-u look up tables have already been generated for 50 observed ages, 100 tau and 100 t values for an exponential decline SFH model for BC03 models. These can be used for a quick starfpy run which is less customised. 

License
---------

Apache 2.

